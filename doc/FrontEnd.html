<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">

<!--

/**
 * Copyright 1999-2004 Carnegie Mellon University.
 * Portions Copyright 2004 Sun Microsystems, Inc.
 * Portions Copyright 2004 Mitsubishi Electronic Research Laboratories.
 * All Rights Reserved.  Use is subject to license terms.
 *
 * See the file "license.terms" for information on usage and
 * redistribution of this file, and for a DISCLAIMER OF ALL
 * WARRANTIES.
 *
 */

-->

<html>
  <head><title>Front End Framework</title></head>
  <body>
    <font face="Times New Roman">
     <center>
     <table bgcolor="#99CCFF" width="100%">
	<tr>
	  <td align=center width="100%">
	    <h1>Front End Framework</h1>
	  </td>
	</tr>
      </table>
    </center>
    </font>

    <font face="Arial" size="2">      
      <p>
        <h3>Table of Contents</h3>
	<ul>
	<li><a href="../javadoc/edu/cmu/sphinx/frontend/FrontEnd.html">An Overview of the FrontEnd</a>
	<li><a href="../javadoc/edu/cmu/sphinx/frontend/doc-files/FrontEndProperties.html">Configuring the Front End</a></li>
	<li><a href="#create_cepstra">Creating MFC Cepstrum/PLP Cepstrum/Spectrum from Audio
	    </a></li>
	<li><a href="#decode_cepstra">Decoding from Cepstra</a></li>
	<li><a href="#enable_endpointer">Enabling the Endpointer</a></li>
	</ul>	
      <p>
      <hr>

      <h3><a name="create_cepstra">Creating MFC Cepstrum/PLP Cepstrum/Spectrum from Audio</a></h3>

      There is a program called FeatureFileDumper that turns an audio file
      into binary cepstra file using the front end.
      To create MFCC cepstrum using this program,
      go to the
      <code>edu/cmu/sphinx/tools/feature</code> directory,
      and type:
      <p>
      <code>ant -Dinput="input file" -Doutput="output file" cepstra_producer</code>
      <p>
      To create a binary PLP cepstrum file using this program, type:
      <p>
      <code>ant -Dinput="input file" -Doutput="output file" plp_producer</code>
      <p>
      To create a binary spectra file, type:
      <p>
      <code>ant -Dinput="input file" -Doutput="output file" spectra_producer
      </code>

      <p>
      As you might notice by comparing the files cepstra_dump.props
      and spectra_dump.props in the "edu/cmu/sphinx/tools/feature" directory,
      the only difference in setup between dumping different types of
      features is in the sequence of data processors as specified in the
      properties file. If you give it a difference data processor sequence,
      it will give you different output.

      <p>
      <b>Binary File Format</b>
      <p>
      The first 4 bytes of the binary file is an integer indicating the total
      number of data points in the file. This is used by the program
      that reads this file to check the endianness of the file 
      by comparing with the file size. The rest of the file is simply 
      the data points. Each data point is a 4-byte floating point number,
      in big-endian order.

      <hr>

      <h3><a name="decode_cepstra">Decoding from Cepstra Files</a></h3>

      <p>
      This normally applies to batch mode decoding using the BatchDecoder.
      There are two important steps in order to decode from cepstra files:
      
      <ol>
      
      <li>Set the sphinx property as:
      <code>edu.cmu.sphinx.decoder.BatchDecoder.inputDataType = cepstrum</code>
      <p>
      Setting this property to "audio" (the default) simply decodes 
      from audio files.
      <p>
      <b>NOTE:</b> <i>Other input data types are not supported yet.</i>

      </li>

      <li>
      Change the front end pipeline to skip the preemphasis,
      windowing, MFCC, and DCT steps. The resulting pipeline should look like:
      <p>
      <code>
      edu.cmu.sphinx.frontend.FrontEndFactory.pipelines=mfc
      <br>mfc;edu.cmu.sphinx.frontend.FrontEndFactory.nStages=2
      <br>mfc;edu.cmu.sphinx.frontend.FrontEndFactory.stage.1.class=edu.cmu.sphinx.frontend.feature.BatchCMN (or LiveCMN)
      <br>mfc;edu.cmu.sphinx.frontend.FrontEndFactory.stage.2.class=edu.cmu.sphinx.frontend.feature.DeltasFeatureExtractor
      </code>
      </li>

      </ol>      

      <hr>

      <h3><a name="enable_endpointer">Enabling the Endpointer</a></h3>

      <p>
      The Sphinx-4 audio endpointer (called LevelTracker) is enabled by
      including it as part of the front end pipeline. The LevelTracker
      should be placed in front of all the other data processors, e.g.,
      <p>
      <code>
      edu.cmu.sphinx.frontend.FrontEndFactory.pipelines=mfc_ep
      <br>mfc_ep;edu.cmu.sphinx.frontend.FrontEndFactory.nStages=9
      <br>mfc_ep;edu.cmu.sphinx.frontend.FrontEndFactory.stage.1.class=edu.cmu.sphinx.frontend.endpoint.LevelTracker
      <br>mfc_ep;edu.cmu.sphinx.frontend.FrontEndFactory.stage.2.class=edu.cmu.sphinx.frontend.filter.Preemphasizer
      <br>...
      </code>

      <p>
      The LevelTracker property 'threshold' controls how sensitive 
      the endpointer is. It is empirically determined that the value of 13
      is optimal for most environments. A lower threshold will make the
      LevelTracker more sensitive, that is, mark more audio as speech.
      A higher threshold will make the endpointer less sensitive, 
      that is, mark less audio as speech.

      <hr>

    </font>      
  </body>
</html>
